<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta  http-equiv="X-UA-Compatible"  content="IE=edge"  >
  <meta  name="viewport"  content="width=device-width, initial-scale=1">
  <meta  http-equiv="Pragma"  content="no-cache">
  <meta http-equiv="Cache-Control"  content="no-cache">
  <meta  http-equiv="Expires"  content="0">
  <title>TUTORIAL 1</title>
  <link
    rel="stylesheet"
    type="text/css"
    href="css/joint.min.css"
  />
<link
  rel="stylesheet"
  type="text/css"
  href="css/contact_lists.css?v=20170628"
/>
<link
  rel="stylesheet"
  type="text/css"
  href="css/jquery-ui.css"
/>
<link
  rel="stylesheet"
  type="text/css"
  href="css/bootstrap.min.css"
>
<!-- .minのほうはテーブルのcontextmenuが反応しなくなる -->
<link
  rel="stylesheet"
  type="text/css"
  href="css/handsontable.full.css?v=20170531"
>
<link
  rel="stylesheet"
  type="text/css"
  href="css/pikaday/pikaday.css"
>
<link
  rel="stylesheet"
  type="text/css"
  href="css/summernote.css?v=20170531"
>
<link
  rel="stylesheet"
  type="text/css"
  href="css/jquery.contextMenu.min.css"
>
<script src="lib/jquery.js"></script>
<script src="lib/jquery-ui.js"></script>
<script src="lib/bootstrap.min.js"></script>
<script src="lib/lodash.js"></script>
<script src="lib/backbone.js"></script>
<script src="lib/joint.min.js"></script>
<script src="lib/moment/moment.js"></script>
<script src="lib/summernote.min.js?v=20170531"></script>
<script src="lib/summernote-ja-JP.min.js?v=20170531"></script>
<script src="lib/jquery.contextMenu.min.js"></script>
<script src="lib/jquery.ui.position.min.js"></script>
<script src="lib/jquery.simple-sidebar.min.js"></script>
<script src="js/contact_lists_model.js?v=20170628"></script>
<script src="js/contact_lists_rest.js?v=20170712"></script>
</head>
<body>
  <div id="paper_1"></div>
  <div class="box_setting">
    <button id="button_1">Add box</button>
    <input id="in_1"></input>
  </div>
  <button id="button_JSON">update JSON</button>
  <div id="JSONspace"></div>

  <script type="text/javascript">
  var graph =new joint.dia.Graph;
  var paper=new joint.dia.Paper({
    el:$('#paper_1'),
    width:600,
    height:200,
    model:graph,
    gridsize:1
  });
  //箱作成
  var rect=new Array();
  var link=new Array();
/*
  var link= new joint.dia.Link({
    source: { id: rect1.id },
    target: { id: rect2.id }
  });
  graph.addCells([rect1,rect2,link]);
*/
  //button_1を押すとボックスが増える
  $('#button_1').on('click',function(){
    rect[rect.length]= new joint.shapes.devs.Model({
      position: { x: 50, y: 50 },
      size: { width: 90, height: 90 },
      inPorts: ['in1','in2'],
      outPorts: ['out'],
      ports: {
        groups: {
          'in': {attrs: {'.port-body': {fill: '#00FF85'}}},
          'out': {attrs: {'.port-body': {fill: '#E74C3C'}}}
        }
      },
      attrs: {'.label': { text: $('#in_1').val(), 'ref-x': .5, 'ref-y': .2 },
      rect: { fill: '#2ECC71' }
    }
  });
  graph.addCells([rect[rect.length-1]]);
});
$('#button_JSON').on('click',function(){
  $('#JSONspace').text(JSON.stringify(graph.toJSON()));
});
</script>
</html>
